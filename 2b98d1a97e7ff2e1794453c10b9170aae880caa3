{
  "comments": [
    {
      "key": {
        "uuid": "8e46e3ee_0a25f102",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 71,
      "author": {
        "id": 128
      },
      "writtenOn": "2017-03-16T16:42:29Z",
      "side": 1,
      "message": "It\u0027s not necessary to pass the sites object here. It might actually be better to get it from global state, since it\u0027s a service. Getting services from the global service factory is expected in wiring code. The caller of the wiring code does not know what dependencies the wiring code may have. That\u0027S actually the point of having callbacks for wiring.",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_a73f3ad2",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 71,
      "author": {
        "id": 920
      },
      "writtenOn": "2017-03-21T15:50:56Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8e46e3ee_0a25f102",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_6a4115ac",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 74,
      "author": {
        "id": 128
      },
      "writtenOn": "2017-03-16T16:42:29Z",
      "side": 1,
      "message": "It seems a bit strange to me to use the SiteLinksRdfBuilder as *the* builder of Items. This works \"by accident\", because Items only need one non-standard bit to be mapped to RDF. \n\nIt\u0027s ok for now, but it deserves a comment, I think. Afterall, a SiteLinksRdfBuilder does *not* provide the RDF mapping for Items.",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_672a9291",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 74,
      "author": {
        "id": 920
      },
      "writtenOn": "2017-03-21T15:50:56Z",
      "side": 1,
      "message": "I agree but making an ItemRdfBuilder that just returns this makes the code overly complicated. I can make it happen if you think it\u0027s worth it.",
      "parentUuid": "8e46e3ee_6a4115ac",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "6e436fe2_d7fb64dd",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 74,
      "author": {
        "id": 128
      },
      "writtenOn": "2017-03-23T18:12:31Z",
      "side": 1,
      "message": "Or just rename SiteLinkRdfBuilder to ItemRdfBuilder?",
      "parentUuid": "8e46e3ee_672a9291",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_1fec55b6",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 2626
      },
      "writtenOn": "2017-03-16T14:49:42Z",
      "side": 1,
      "message": "I know it is copied over but DedupeBag could also be injected in SiteLinksRdfBuilder\u0027s constructor, couldn\u0027t it? But this should be in a separate patch if at all.",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_df3a6de4",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 920
      },
      "writtenOn": "2017-03-16T15:21:13Z",
      "side": 1,
      "message": "I actively checked for that. It\u0027s not possible.",
      "parentUuid": "8e46e3ee_1fec55b6",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_0a48915f",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 2626
      },
      "writtenOn": "2017-03-16T15:26:13Z",
      "side": 1,
      "message": "Discussing off topic as I think this potential change should not be part of this patch: why it is not possible?\nI don\u0027t know this part of the code but this seems to be the only place SiteLinksRdfBuilder is instantiated, and we have $dedupe here, so why it cannot be another constructor parameter? What does break?",
      "parentUuid": "8e46e3ee_df3a6de4",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_ca86296a",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 920
      },
      "writtenOn": "2017-03-16T15:31:13Z",
      "side": 1,
      "message": "Oh, you meant changing the constructor of the SiteLinksRdfBuilder. I thought you meant just changing it here. I agree we should change that. Let\u0027s do it in a followup",
      "parentUuid": "8e46e3ee_0a48915f",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_aae87db0",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 75,
      "author": {
        "id": 128
      },
      "writtenOn": "2017-03-16T16:42:29Z",
      "side": 1,
      "message": "To avoid overloading constructors, I find it a good approach to use setter injection for anything that is optional or has a sensible default. The dedupe bag is optional, so it doesn\u0027t need to be in the constructor.\n\nWe can add it there anyway, but as a general rule, it\u0027s fine for optional things to use setters instead of the constructor.",
      "parentUuid": "8e46e3ee_ca86296a",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_8471f8df",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 77,
      "author": {
        "id": 2626
      },
      "writtenOn": "2017-03-16T14:49:42Z",
      "side": 1,
      "message": "else branch not really needed, can be simply omitted.",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_8a058115",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 77,
      "author": {
        "id": 920
      },
      "writtenOn": "2017-03-16T15:21:13Z",
      "side": 1,
      "message": "It makes the EntityRdfBuilderFactory to fail (the post condition) because it says the callback isn\u0027t returning an instance of EntityRdfBuilder. I can change to return NullEntityRdfBuilder only (and cut the else part) if that\u0027s what you mean.",
      "parentUuid": "8e46e3ee_8471f8df",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_ca49496c",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 77,
      "author": {
        "id": 2626
      },
      "writtenOn": "2017-03-16T15:26:13Z",
      "side": 1,
      "message": "Yeah, sorry for not being clear.\nI meant:\n\nif ( foo ) {\n    return X;\n}\n\nreturn Y;",
      "parentUuid": "8e46e3ee_8a058115",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_ca006970",
        "filename": "repo/WikibaseRepo.entitytypes.php",
        "patchSetId": 1
      },
      "lineNbr": 77,
      "author": {
        "id": 128
      },
      "writtenOn": "2017-03-16T16:42:29Z",
      "side": 1,
      "message": "This is very much a matter of taste. Some prefer the full if/else pair. Some prefer if-for-the-special-case, and fall-through for the \"happy path\". \n\nI have gone back and forth myself on this a couple of times. I no longer care :)",
      "parentUuid": "8e46e3ee_ca49496c",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_7ffa3975",
        "filename": "repo/includes/Rdf/EntityRdfBuilderFactory.php",
        "patchSetId": 1
      },
      "lineNbr": 51,
      "author": {
        "id": 2626
      },
      "writtenOn": "2017-03-16T14:49:42Z",
      "side": 1,
      "message": "Missing from the @param docs above.\n\nAdding SiteList to argument list is not very nice as it is only relevant for site-specific builder, or maybe item builder. But I guess there no really nice way around it.\nOr would we prefer to call WikibaseRepo::getSiteLookup()-\u003egetSites() in item\u0027s entity type definition file?",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_ea752593",
        "filename": "repo/includes/Rdf/EntityRdfBuilderFactory.php",
        "patchSetId": 1
      },
      "lineNbr": 51,
      "author": {
        "id": 920
      },
      "writtenOn": "2017-03-16T15:27:33Z",
      "side": 1,
      "message": "It would be great but also it would make the $sites arguments in the RdfBuilder constructor completely unused (and needs lots of cleanup) + I guess we need to rewrite some tests here.",
      "parentUuid": "8e46e3ee_7ffa3975",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_0a4e51dd",
        "filename": "repo/includes/Rdf/EntityRdfBuilderFactory.php",
        "patchSetId": 1
      },
      "lineNbr": 79,
      "author": {
        "id": 128
      },
      "writtenOn": "2017-03-16T16:42:29Z",
      "side": 1,
      "message": "It\u0027s not necessary to inject all services that any RdfBuilder might need. In fact, we cannot know here what they might need. \n\nThe wikibase.entitytypes.php file is a wiring file; as such, it can us global state to get the service instances it needs.",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_27348af0",
        "filename": "repo/includes/Rdf/EntityRdfBuilderFactory.php",
        "patchSetId": 1
      },
      "lineNbr": 79,
      "author": {
        "id": 920
      },
      "writtenOn": "2017-03-21T15:50:56Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "8e46e3ee_0a4e51dd",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_dfdeed13",
        "filename": "repo/includes/Rdf/NullEntityRdfBuilder.php",
        "patchSetId": 1
      },
      "lineNbr": 3,
      "author": {
        "id": 2626
      },
      "writtenOn": "2017-03-16T14:49:42Z",
      "side": 1,
      "message": "Minor: Wouldn\u0027t we want this to be in Wikibase\\Repo\\Rdf?",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_4a6539dc",
        "filename": "repo/includes/Rdf/NullEntityRdfBuilder.php",
        "patchSetId": 1
      },
      "lineNbr": 3,
      "author": {
        "id": 920
      },
      "writtenOn": "2017-03-16T15:27:33Z",
      "side": 1,
      "message": "I\u0027d love to but it seems all of php files in the Rdf folder are in Wikibase\\Rdf namespace (which needs fixing but it will be really big patch)",
      "parentUuid": "8e46e3ee_dfdeed13",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_aaff1d61",
        "filename": "repo/includes/Rdf/NullEntityRdfBuilder.php",
        "patchSetId": 1
      },
      "lineNbr": 3,
      "author": {
        "id": 128
      },
      "writtenOn": "2017-03-16T16:42:29Z",
      "side": 1,
      "message": "Instead of putting the Rdf stuff into repo, I\u0027d rather move it into a separate component that *doesn\u0027t* depend on repo.",
      "parentUuid": "8e46e3ee_4a6539dc",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8e46e3ee_ca2f09f2",
        "filename": "repo/tests/phpunit/includes/Rdf/EntityRdfBuilderFactoryTest.php",
        "patchSetId": 1
      },
      "lineNbr": 52,
      "author": {
        "id": 128
      },
      "writtenOn": "2017-03-16T16:42:29Z",
      "side": 1,
      "message": "Do we not need to define some sites, so we can see sites in the test output?",
      "revId": "2b98d1a97e7ff2e1794453c10b9170aae880caa3",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}