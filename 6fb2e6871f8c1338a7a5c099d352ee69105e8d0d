{
  "comments": [
    {
      "key": {
        "uuid": "0e81134c_7ec6f64f",
        "filename": "client/includes/Hooks/ChangesListLinesHandler.php",
        "patchSetId": 6
      },
      "lineNbr": 23,
      "author": {
        "id": 920
      },
      "writtenOn": "2017-06-09T07:58:26Z",
      "side": 1,
      "message": "It looks like it\u0027s a singleton and singletons usually should be avoided. Making it a part of WikibaseRepo (like most services) would be the best option I think.",
      "revId": "6fb2e6871f8c1338a7a5c099d352ee69105e8d0d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e81134c_7e8596b0",
        "filename": "client/includes/Hooks/ChangesListLinesHandler.php",
        "patchSetId": 6
      },
      "lineNbr": 23,
      "author": {
        "id": 2664
      },
      "writtenOn": "2017-06-09T09:58:26Z",
      "side": 1,
      "message": "(Did you mean WikibaseClient?) I have just scrolled through WBC and didn\u0027t find any hook handlers stored there. So would you hint me how it should look like?",
      "parentUuid": "0e81134c_7ec6f64f",
      "revId": "6fb2e6871f8c1338a7a5c099d352ee69105e8d0d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e81134c_2a633e3d",
        "filename": "client/includes/Hooks/ChangesListLinesHandler.php",
        "patchSetId": 6
      },
      "lineNbr": 23,
      "author": {
        "id": 920
      },
      "writtenOn": "2017-06-12T08:49:43Z",
      "side": 1,
      "message": "Yes, As an example I can see InfoActionHookHandler but it\u0027s not in WikibaseClient, it\u0027s in the other part but it\u0027s not a singleton which is my point.",
      "parentUuid": "0e81134c_7e8596b0",
      "revId": "6fb2e6871f8c1338a7a5c099d352ee69105e8d0d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e81134c_748b641c",
        "filename": "client/includes/Hooks/ChangesListLinesHandler.php",
        "patchSetId": 6
      },
      "lineNbr": 23,
      "author": {
        "id": 2626
      },
      "writtenOn": "2017-06-13T11:47:37Z",
      "side": 1,
      "message": "I believe what avoiding the singleton (kind of) could like would be by using this class in Wikibase\\ClientHooks.\nTwo methods would be added there, and the instance(s) of the hook handler will created there, instead of ChangesListLinesHandler::onOldChangesListRecentChangesLine and ChangesListLinesHandler::onEnhancedChangesListModifyBlockLineData instantiate it.",
      "parentUuid": "0e81134c_2a633e3d",
      "revId": "6fb2e6871f8c1338a7a5c099d352ee69105e8d0d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e81134c_d7825297",
        "filename": "client/includes/Hooks/ChangesListLinesHandler.php",
        "patchSetId": 6
      },
      "lineNbr": 23,
      "author": {
        "id": 2664
      },
      "writtenOn": "2017-06-13T13:43:17Z",
      "side": 1,
      "message": "If this shouldn\u0027t be a singleton class, we just need to replace getInstance calls with newFromGlobalState ones.\n\nI should finally explain why I initially made it singleton. I noticed that ChangesList is, in fact, a \"singleton\" (only one instance is created). The dependencies for this class are obtained from this ChangesList class, so I didn\u0027t see any problem in having a single instance during handling because this is what I saw in other hook classes.\n\nOTOH the previous code created a new formatter for each line.",
      "parentUuid": "0e81134c_748b641c",
      "revId": "6fb2e6871f8c1338a7a5c099d352ee69105e8d0d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e81134c_94904848",
        "filename": "client/includes/Hooks/ChangesListLinesHandler.php",
        "patchSetId": 6
      },
      "lineNbr": 50,
      "author": {
        "id": 2626
      },
      "writtenOn": "2017-06-13T11:47:37Z",
      "side": 1,
      "message": "@param ChangesList $changesList\n\nCould also be skipped IMO, as there is a type hint in the param list.",
      "revId": "6fb2e6871f8c1338a7a5c099d352ee69105e8d0d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e81134c_3495dc35",
        "filename": "client/includes/Hooks/ChangesListLinesHandler.php",
        "patchSetId": 6
      },
      "lineNbr": 68,
      "author": {
        "id": 2626
      },
      "writtenOn": "2017-06-13T11:47:37Z",
      "side": 1,
      "message": "@param ChangesList $changesList\n\nCould also add type hint to the param list as above (and possibly phpdoc no longer needed then?)",
      "revId": "6fb2e6871f8c1338a7a5c099d352ee69105e8d0d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e81134c_f462f405",
        "filename": "client/includes/RecentChanges/ChangeLineFormatter.php",
        "patchSetId": 6
      },
      "lineNbr": 205,
      "author": {
        "id": 2626
      },
      "writtenOn": "2017-06-13T11:47:37Z",
      "side": 1,
      "message": "hmm, shouldn\u0027t this be: string[] Array of HTML strings\n\nor something like this?\n\nI mean that \"HTML\" is not \"standard\" and does not match PHP type, whereas string does.\n\nBTW: are we sure that this always returns two-element array? If so, this could maybe also be documented?",
      "revId": "6fb2e6871f8c1338a7a5c099d352ee69105e8d0d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e81134c_b7f8ee47",
        "filename": "client/includes/RecentChanges/ChangeLineFormatter.php",
        "patchSetId": 6
      },
      "lineNbr": 205,
      "author": {
        "id": 2664
      },
      "writtenOn": "2017-06-13T13:43:17Z",
      "side": 1,
      "message": "yeah, this is another my invention that I should stop doing now ;)\n\n(well, I have just found one or two HTML\u0027s in core, so I\u0027m not the first one)",
      "parentUuid": "0e81134c_f462f405",
      "revId": "6fb2e6871f8c1338a7a5c099d352ee69105e8d0d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e81134c_d4a0109d",
        "filename": "client/includes/RecentChanges/RecentChangeFactory.php",
        "patchSetId": 6
      },
      "lineNbr": 254,
      "author": {
        "id": 2626
      },
      "writtenOn": "2017-06-13T11:47:37Z",
      "side": 1,
      "message": "I am not super happy of this method being here. Nothing related to the factory really, is it?\n\nOTOH I understand the intention to have this check in a single place, not duplicated in all classes that possibly need to check this. And I also understand that there might not be a better place in the current code to put such a method.\n\nStill, I wonder, maybe it would be OK to have something similar as a private method in ChangesListLinesHandler, and just an inline check in ChangesListSpecialPageHookHandlers?",
      "revId": "6fb2e6871f8c1338a7a5c099d352ee69105e8d0d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0e81134c_97212aaf",
        "filename": "client/includes/RecentChanges/RecentChangeFactory.php",
        "patchSetId": 6
      },
      "lineNbr": 254,
      "author": {
        "id": 2664
      },
      "writtenOn": "2017-06-13T13:43:17Z",
      "side": 1,
      "message": "Indeed, when I started coding, I created a private method in the new class. And yeah, this is a factory class, so perhaps nothing but factoring objects should happen here.",
      "parentUuid": "0e81134c_d4a0109d",
      "revId": "6fb2e6871f8c1338a7a5c099d352ee69105e8d0d",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}