{
  "comments": [
    {
      "key": {
        "uuid": "7c86dee9_fb27e3aa",
        "filename": "client/includes/Notifications/PageConnectionPresentationModel.php",
        "patchSetId": 1
      },
      "lineNbr": 29,
      "author": {
        "id": 106
      },
      "writtenOn": "2018-09-20T07:53:13Z",
      "side": 1,
      "message": "I\u0027m not sure how this would actually end up affecting getBundleCount?\nIt looks like perhaps we should be passing a numm callback into that method instead.\n\nIf you think this sounds fine though Sbisson LGTM!",
      "range": {
        "startLine": 23,
        "startChar": 1,
        "endLine": 29,
        "endChar": 2
      },
      "revId": "cc94e17fc796bf1f7f86eb9693941760c04bfe06",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f8cab05_20ee1331",
        "filename": "client/includes/Notifications/PageConnectionPresentationModel.php",
        "patchSetId": 1
      },
      "lineNbr": 29,
      "author": {
        "id": 2488
      },
      "writtenOn": "2018-09-20T15:53:24Z",
      "side": 1,
      "message": "I\u0027m fine with this code in the sense that it won\u0027t produce any error ;)\n\nHowever I can\u0027t really speak to the business logic of the \u0027page-connection\u0027 notification.\n\nI\u0027m not sure why some EchoEvents don\u0027t have a title. Looking at the code[1], it looks like events are just not created without a title. There might be a different code path creating these notifications that I haven\u0027t seen.\n\nIt\u0027s also possible that the title is not available in the replica yet, in which case `$event-\u003egetTitle (true );` would be needed to read it from master but it would be wise to add instrumentation as a first step before spreading \"read from master\" left and right.\n\n[1] https://gerrit.wikimedia.org/g/mediawiki/extensions/Wikibase/+/57a5d0f8703dbf562e758e768f733de6db063ecf/client/includes/Hooks/EchoNotificationsHandlers.php#166",
      "parentUuid": "7c86dee9_fb27e3aa",
      "range": {
        "startLine": 23,
        "startChar": 1,
        "endLine": 29,
        "endChar": 2
      },
      "revId": "cc94e17fc796bf1f7f86eb9693941760c04bfe06",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "86ac4799_186f042f",
        "filename": "client/includes/Notifications/PageConnectionPresentationModel.php",
        "patchSetId": 1
      },
      "lineNbr": 29,
      "author": {
        "id": 34
      },
      "writtenOn": "2018-09-26T02:36:11Z",
      "side": 1,
      "message": "The code for EchoEvent in Echo:/Event.php looks to me like \u0027title\u0027 and and \u0027pageId\u0027 are both optional. There is strict validation about title being a Title object, but beyond that it tolerates a Title that doesn\u0027t exist (getArticleId is used for the conditional), and also tolerates when the field is missing entirely.\n\nIf that is unexpected, instrumenting that at creation time would be interesting.\n\nAs for this Wikibase code, how should the bundle count be computed for events without a title?\n\nGiven the default behaviour of Echo to not group events, unless explicitly set to be grouped, I would assume that events without a title should be counted individually.\n\nHowever, returning null from here would mean all similar events get de-duplicated into one \u0027null\u0027 category and counted as one, which seems unintended. Is there a safe return value for this callback that will make it count each? Not sure what the convention is for that., maybe something unique like the event ID?",
      "parentUuid": "9f8cab05_20ee1331",
      "range": {
        "startLine": 23,
        "startChar": 1,
        "endLine": 29,
        "endChar": 2
      },
      "revId": "cc94e17fc796bf1f7f86eb9693941760c04bfe06",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "98ed2d90_565bd9c7",
        "filename": "client/includes/Notifications/PageConnectionPresentationModel.php",
        "patchSetId": 1
      },
      "lineNbr": 29,
      "author": {
        "id": 2664
      },
      "writtenOn": "2018-09-26T12:08:16Z",
      "side": 1,
      "message": "Perhaps the events should be array_filter\u0027d with canRender in getBundleCount before using this callback. Seems that the only path to have getTitle() return null is deleting the page and then trying to fetch it by id (which fails).",
      "parentUuid": "86ac4799_186f042f",
      "range": {
        "startLine": 23,
        "startChar": 1,
        "endLine": 29,
        "endChar": 2
      },
      "revId": "cc94e17fc796bf1f7f86eb9693941760c04bfe06",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}