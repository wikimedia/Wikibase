{
  "comments": [
    {
      "key": {
        "uuid": "d9461690_74148fe8",
        "filename": "repo/includes/Search/Elastic/Query/HasWbStatementFeature.php",
        "patchSetId": 7
      },
      "lineNbr": 152,
      "author": {
        "id": 2096
      },
      "writtenOn": "2018-04-23T17:43:52Z",
      "side": 1,
      "message": "I don\u0027t think we should actually do that. The reason is we may index properties not only by ID, but by type or by any marker. So I think I disagree with David here - we shouldn\u0027t check anything, and if it\u0027s not indexed, then the search won\u0027t find anything. It\u0027s not a problem.",
      "revId": "b4be5dccd9122d91f749dbd3fe58b66f3bce9d50",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "151ee97e_bf8498ea",
        "filename": "repo/includes/Search/Elastic/Query/HasWbStatementFeature.php",
        "patchSetId": 7
      },
      "lineNbr": 152,
      "author": {
        "id": 5246
      },
      "writtenOn": "2018-04-24T14:30:22Z",
      "side": 1,
      "message": "As far as I can see in the code only Statements where Statement::getMainSnak()::getPropertyId()::getSerialization() returns a value that is in the array $GLOBALS[\u0027wgWBRepoSettings\u0027][\u0027searchIndexProperties\u0027] can get indexed, so I think this is correct\n\nPerhaps I\u0027m missing something? Or perhaps a variable is poorly named/commented?\n\nI think David\u0027s concern about users is fair - a user is likely to be puzzled if they search for haswbstatement:P999\u003dQ88 and get no results, even though they *know* that item X has the statement P999\u003dQ888",
      "parentUuid": "d9461690_74148fe8",
      "revId": "b4be5dccd9122d91f749dbd3fe58b66f3bce9d50",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f1b09272_491e8ae1",
        "filename": "repo/includes/Search/Elastic/Query/HasWbStatementFeature.php",
        "patchSetId": 7
      },
      "lineNbr": 152,
      "author": {
        "id": 2096
      },
      "writtenOn": "2018-04-24T17:34:24Z",
      "side": 1,
      "message": "This is correct in the current code, where the only properties indexed are those in searchIndexProperties. However, with https://phabricator.wikimedia.org/T99899 and https://gerrit.wikimedia.org/r/c/427836/ it is going to change, and in general we won\u0027t have a fixed list of properties that we index. \n\n\u003e a user is likely to be puzzled if they search for haswbstatement:P999\u003dQ88 and get no results, even though they *know* that item X has the statement P999\u003dQ888\n\nIf the property is not indexed, then it won\u0027t be found. This is true for all searches - if you don\u0027t index something, you don\u0027t find it. I don\u0027t see how anything changes here. We may need some docs on it, but using searchIndexProperties is not going to work.",
      "parentUuid": "151ee97e_bf8498ea",
      "revId": "b4be5dccd9122d91f749dbd3fe58b66f3bce9d50",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "95cdde5d_27a4f280",
        "filename": "repo/includes/Search/Elastic/Query/HasWbStatementFeature.php",
        "patchSetId": 7
      },
      "lineNbr": 152,
      "author": {
        "id": 5246
      },
      "writtenOn": "2018-04-25T16:59:50Z",
      "side": 1,
      "message": "\u003e If the property is not indexed, then it won\u0027t be found. This is true for all searches\n\nI understand that, I just think from a user perspective it\u0027s going to be weird to search for something you know exists and get no results, without any clue as to why\n\nBut as you say T99899 makes the code here wrong one way or the other. Changed",
      "parentUuid": "f1b09272_491e8ae1",
      "revId": "b4be5dccd9122d91f749dbd3fe58b66f3bce9d50",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6d952aa2_ff50131c",
        "filename": "repo/includes/Search/Elastic/Query/HasWbStatementFeature.php",
        "patchSetId": 7
      },
      "lineNbr": 152,
      "author": {
        "id": 2096
      },
      "writtenOn": "2018-04-25T18:14:33Z",
      "side": 1,
      "message": "Well, yes, you are right, but I\u0027m not seeing a good way of checking this unless we have an API for that in Wikibase. Maybe we should, but that would require some refactoring - decision of whether to index the property may not be as trivial as checking in the list anymore, we will include or exclude properties by variety of criteria in the future, not only by fixed list. \nIf you\u0027d like you can make a patch to have indexer to use generic API (some class/interface I guess) and use the same API here to check whether or not the property is indexed. But I think it\u0027d be beyond the goals of this patch.",
      "parentUuid": "95cdde5d_27a4f280",
      "revId": "b4be5dccd9122d91f749dbd3fe58b66f3bce9d50",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    }
  ]
}