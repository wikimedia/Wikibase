{
  "comments": [
    {
      "key": {
        "uuid": "4e7eab26_0db7adf2",
        "filename": "repo/config/ElasticSearchRescoreFunctions.php",
        "patchSetId": 4
      },
      "lineNbr": 10,
      "author": {
        "id": 1453
      },
      "writtenOn": "2017-09-01T07:21:27Z",
      "side": 1,
      "message": "Can you briefly explain (ideally in the commit message) what these numbers represent? Thanks!",
      "range": {
        "startLine": 10,
        "startChar": 63,
        "endLine": 10,
        "endChar": 83
      },
      "revId": "aa822b8c94d717b1ecad05f0d16800801609abd1",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e7eab26_0e9d600c",
        "filename": "repo/config/ElasticSearchRescoreFunctions.php",
        "patchSetId": 4
      },
      "lineNbr": 10,
      "author": {
        "id": 2096
      },
      "writtenOn": "2017-09-01T22:12:50Z",
      "side": 1,
      "message": "These are parameters for saturation function. Mainly guesses of how the function shape should look like.",
      "parentUuid": "4e7eab26_0db7adf2",
      "range": {
        "startLine": 10,
        "startChar": 63,
        "endLine": 10,
        "endChar": 83
      },
      "revId": "aa822b8c94d717b1ecad05f0d16800801609abd1",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e7eab26_e6f9021a",
        "filename": "repo/config/ElasticSearchRescoreFunctions.php",
        "patchSetId": 4
      },
      "lineNbr": 10,
      "author": {
        "id": 2638
      },
      "writtenOn": "2017-09-06T08:22:39Z",
      "side": 1,
      "message": "The saturation function is taken from cirrus code (https://github.com/wikimedia/mediawiki-extensions-CirrusSearch/blob/60edf9b8c5a27e53dd954c349dfa8e958259108a/includes/Search/RescoreBuilders.php#L830)\n\nBasically it produces a normalized score between 0 and 1,\n   - k controls the midpoint: when incoming links \u003d\u003d k the score is always 0.5.\n   - a controls the shape with a sigmoid, basically it controls how steep the curve is at the midpoint. With high value of \"a\" it\u0027ll be on/off (inclinks \u003c k \u003d\u003e 0, 1 otherwize)\n\nThis function is very similar to https://en.wikipedia.org/wiki/Logistic_function\n\nNote that the max value is always 1 but the weight param is applied on the function result making the max value equals to the weight set.\n\nIn this example the result score of incoming_links will be bounded between 0 and 1.2.",
      "parentUuid": "4e7eab26_0e9d600c",
      "range": {
        "startLine": 10,
        "startChar": 63,
        "endLine": 10,
        "endChar": 83
      },
      "revId": "aa822b8c94d717b1ecad05f0d16800801609abd1",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e7eab26_2dbaa9da",
        "filename": "repo/config/EntityPrefixSearchProfiles.php",
        "patchSetId": 4
      },
      "lineNbr": 15,
      "author": {
        "id": 1453
      },
      "writtenOn": "2017-09-01T07:21:27Z",
      "side": 1,
      "message": "Indeed. Can you please add a short sentence to the commit message that explains where the new numbers in this patch come from? Thanks.",
      "range": {
        "startLine": 15,
        "startChar": 21,
        "endLine": 15,
        "endChar": 59
      },
      "revId": "aa822b8c94d717b1ecad05f0d16800801609abd1",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e7eab26_0ee6c0aa",
        "filename": "repo/config/EntityPrefixSearchProfiles.php",
        "patchSetId": 4
      },
      "lineNbr": 15,
      "author": {
        "id": 2096
      },
      "writtenOn": "2017-09-01T22:12:50Z",
      "side": 1,
      "message": "They come from mostly guesswork about which numbers give better results.",
      "parentUuid": "4e7eab26_2dbaa9da",
      "range": {
        "startLine": 15,
        "startChar": 21,
        "endLine": 15,
        "endChar": 59
      },
      "revId": "aa822b8c94d717b1ecad05f0d16800801609abd1",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e7eab26_8dd63df4",
        "filename": "repo/includes/Search/Elastic/EntitySearchElastic.php",
        "patchSetId": 4
      },
      "lineNbr": 156,
      "author": {
        "id": 2638
      },
      "writtenOn": "2017-09-01T07:47:43Z",
      "side": 1,
      "message": "Thinking about it twice dismax might still be better than a bool query.\nIn fact setting TieBreaker to 1 should be equivalent to using a boolean (which will sum everything)\nSo probably still most flexible to use dismax vs boolean here.\nBasically the formula is : best_score + (sum of remaining_scores)*tie_breaker;\nThe question now would be: should we make tie breaker configurable?",
      "revId": "aa822b8c94d717b1ecad05f0d16800801609abd1",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e7eab26_4e97e8ee",
        "filename": "repo/includes/Search/Elastic/EntitySearchElastic.php",
        "patchSetId": 4
      },
      "lineNbr": 156,
      "author": {
        "id": 2096
      },
      "writtenOn": "2017-09-01T22:12:50Z",
      "side": 1,
      "message": "I don\u0027t think non-best scores should matter too much. I mean, if you already matched exact one in primary language, nobody cares if a secondary language matches. Match in two languages is not better than match in one. \nOTOH, match in primary language on a so-so article should be much better than match in secondary one on a good one. So, the entity weight (rescore) should be very important within the same language, but if you match in different language, that should be less imoortant even if the article is good.",
      "parentUuid": "4e7eab26_8dd63df4",
      "revId": "aa822b8c94d717b1ecad05f0d16800801609abd1",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e7eab26_240714ce",
        "filename": "repo/includes/Search/Elastic/EntitySearchElastic.php",
        "patchSetId": 4
      },
      "lineNbr": 156,
      "author": {
        "id": 128
      },
      "writtenOn": "2017-09-04T12:43:52Z",
      "side": 1,
      "message": "Is it possible to score \"no match\" and \"mismatch\" differently? I mean - if you have a match on a secondary language with a mediocre score, the score should be high, unless you have an explicit mismatch in the primary language. Then it\u0027s probably a false friend.",
      "parentUuid": "4e7eab26_4e97e8ee",
      "revId": "aa822b8c94d717b1ecad05f0d16800801609abd1",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4e7eab26_9b141753",
        "filename": "repo/includes/Search/Elastic/EntitySearchElastic.php",
        "patchSetId": 4
      },
      "lineNbr": 156,
      "author": {
        "id": 2638
      },
      "writtenOn": "2017-09-06T08:22:39Z",
      "side": 1,
      "message": "What do you mean by \"match on a secondary language with a mediocre score\" ?\n\nHere we use constant scores so that a match will always have a score equals to the boost set. Basically it\u0027s binary: score on a particular field is 0 or equals to the boost set in the profile.",
      "parentUuid": "4e7eab26_240714ce",
      "revId": "aa822b8c94d717b1ecad05f0d16800801609abd1",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    }
  ]
}