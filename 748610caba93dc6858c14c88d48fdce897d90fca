{
  "comments": [
    {
      "key": {
        "uuid": "9c4ef011_d6e96188",
        "filename": "client/data-bridge/src/mediawiki/data-bridge.init.ts",
        "patchSetId": 2
      },
      "lineNbr": 6,
      "author": {
        "id": 5897
      },
      "writtenOn": "2019-06-25T11:07:33Z",
      "side": 1,
      "message": "why not just for the moment?:\n```\n\t// eslint-disable-next-line no-console\n\tconsole.log( `Number of links potentially usable for data bridge: ${ selectLinks().length }` );\n```",
      "range": {
        "startLine": 4,
        "startChar": 1,
        "endLine": 6,
        "endChar": 93
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9098f7d0_bd257504",
        "filename": "client/data-bridge/src/mediawiki/data-bridge.init.ts",
        "patchSetId": 2
      },
      "lineNbr": 6,
      "author": {
        "id": 6546
      },
      "writtenOn": "2019-06-25T11:45:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9c4ef011_d6e96188",
      "range": {
        "startLine": 4,
        "startChar": 1,
        "endLine": 6,
        "endChar": 93
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7ead5cfd_5f00a55d",
        "filename": "client/data-bridge/src/mediawiki/selectLinks.ts",
        "patchSetId": 2
      },
      "lineNbr": 2,
      "author": {
        "id": 5121
      },
      "writtenOn": "2019-06-25T11:02:11Z",
      "side": 1,
      "message": "This should be sourced from `mw.config.get( \u0027wbRepo\u0027 )`.\nI\u0027m not sure how you imagine this to proceed - maybe you want to iteratively improve it, so it would be fair to add it this way now, but then we should track the todo so we don\u0027t forget.\nPersonally I could also do with going slower but having a full featured implementation when we are \"done\".",
      "range": {
        "startLine": 2,
        "startChar": 22,
        "endLine": 2,
        "endChar": 56
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ef577bf7_034f39a4",
        "filename": "client/data-bridge/src/mediawiki/selectLinks.ts",
        "patchSetId": 2
      },
      "lineNbr": 2,
      "author": {
        "id": 5897
      },
      "writtenOn": "2019-06-25T11:07:33Z",
      "side": 1,
      "message": "+1",
      "parentUuid": "7ead5cfd_5f00a55d",
      "range": {
        "startLine": 2,
        "startChar": 22,
        "endLine": 2,
        "endChar": 56
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "983dfacd_0a237095",
        "filename": "client/data-bridge/src/mediawiki/selectLinks.ts",
        "patchSetId": 2
      },
      "lineNbr": 2,
      "author": {
        "id": 4699
      },
      "writtenOn": "2019-06-25T11:37:29Z",
      "side": 1,
      "message": "Well, since it’s totally unrelated to this change, I don’t think even a TODO should be added here. (We can upload a separate change to do that, of course, until we’ve implemented the proper solution.)",
      "parentUuid": "ef577bf7_034f39a4",
      "range": {
        "startLine": 2,
        "startChar": 22,
        "endLine": 2,
        "endChar": 56
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ca7cf6da_84fcc0ba",
        "filename": "client/data-bridge/src/mediawiki/selectLinks.ts",
        "patchSetId": 2
      },
      "lineNbr": 2,
      "author": {
        "id": 6546
      },
      "writtenOn": "2019-06-25T11:45:21Z",
      "side": 1,
      "message": "Let\u0027s do this in an extra patch as it involves touching files outside of data-bridge.",
      "parentUuid": "ef577bf7_034f39a4",
      "range": {
        "startLine": 2,
        "startChar": 22,
        "endLine": 2,
        "endChar": 56
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "da53dad6_ff3bb44b",
        "filename": "client/data-bridge/src/mediawiki/selectLinks.ts",
        "patchSetId": 2
      },
      "lineNbr": 4,
      "author": {
        "id": 5897
      },
      "writtenOn": "2019-06-25T11:07:33Z",
      "side": 1,
      "message": "why not ( ... ): ... \u003d\u003e { ... } ?",
      "range": {
        "startLine": 4,
        "startChar": 12,
        "endLine": 4,
        "endChar": 40
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b7c14d50_38511006",
        "filename": "client/data-bridge/src/mediawiki/selectLinks.ts",
        "patchSetId": 2
      },
      "lineNbr": 4,
      "author": {
        "id": 6546
      },
      "writtenOn": "2019-06-25T11:45:21Z",
      "side": 1,
      "message": "Because this was not the goal of this patch, so tried to do as little unrelated refactoring as possible. But I can include it, if you wish.",
      "parentUuid": "da53dad6_ff3bb44b",
      "range": {
        "startLine": 4,
        "startChar": 12,
        "endLine": 4,
        "endChar": 40
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e0681c42_3471716a",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 5121
      },
      "writtenOn": "2019-06-25T11:02:11Z",
      "side": 1,
      "message": "File name should be `selectLinks.spec.ts` to ease finding the spec to the source.",
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "37186f52_8671d9b9",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 0,
      "author": {
        "id": 6546
      },
      "writtenOn": "2019-06-25T11:45:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e0681c42_3471716a",
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0901fbc7_e71127a0",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 5121
      },
      "writtenOn": "2019-06-25T11:02:11Z",
      "side": 1,
      "message": "There is `@` at our disposal to import using a friendly absolute path.",
      "range": {
        "startLine": 1,
        "startChar": 25,
        "endLine": 1,
        "endChar": 37
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "31285205_11815d3d",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 5897
      },
      "writtenOn": "2019-06-25T11:07:33Z",
      "side": 1,
      "message": "@",
      "range": {
        "startLine": 1,
        "startChar": 25,
        "endLine": 1,
        "endChar": 37
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "02549652_2bd8ee91",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 1,
      "author": {
        "id": 6546
      },
      "writtenOn": "2019-06-25T11:45:21Z",
      "side": 1,
      "message": "Fixed and works, but confuses my IDE. Will look into that.",
      "parentUuid": "31285205_11815d3d",
      "range": {
        "startLine": 1,
        "startChar": 25,
        "endLine": 1,
        "endChar": 37
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "86656c0e_6745a14d",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 3,
      "author": {
        "id": 5121
      },
      "writtenOn": "2019-06-25T11:02:11Z",
      "side": 1,
      "message": "\u0027find relevant links in mark-up\u0027 maybe.",
      "range": {
        "startLine": 3,
        "startChar": 7,
        "endLine": 3,
        "endChar": 10
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "02310763_0406a5a4",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 3,
      "author": {
        "id": 5897
      },
      "writtenOn": "2019-06-25T11:07:33Z",
      "side": 1,
      "message": "this should be inside of a describe(name, fn)",
      "range": {
        "startLine": 3,
        "startChar": 0,
        "endLine": 3,
        "endChar": 20
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f1a34b2_92f1e684",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 3,
      "author": {
        "id": 6546
      },
      "writtenOn": "2019-06-25T11:45:21Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "86656c0e_6745a14d",
      "range": {
        "startLine": 3,
        "startChar": 7,
        "endLine": 3,
        "endChar": 10
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "34be5e96_b1f26006",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 4,
      "author": {
        "id": 5121
      },
      "writtenOn": "2019-06-25T11:02:11Z",
      "side": 1,
      "message": "I\u0027m shocked that this \"just works\" - looking into \"why\" and pros/cons using something like https://github.com/jsdom/jsdom instead.",
      "range": {
        "startLine": 4,
        "startChar": 1,
        "endLine": 4,
        "endChar": 24
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e414100d_3f04115d",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 4,
      "author": {
        "id": 6546
      },
      "writtenOn": "2019-06-25T11:45:21Z",
      "side": 1,
      "message": "This is what the documentation says: https://jestjs.io/docs/en/tutorial-jquery",
      "parentUuid": "34be5e96_b1f26006",
      "range": {
        "startLine": 4,
        "startChar": 1,
        "endLine": 4,
        "endChar": 24
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "22ea9155_8e515433",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 4,
      "author": {
        "id": 5121
      },
      "writtenOn": "2019-06-25T11:47:13Z",
      "side": 1,
      "message": "I read up and found out that through the default config we are actually using jsdom, and we get test isolation for free as this also taken care of for us. The more you know.\nhttps://jestjs.io/docs/en/configuration#testenvironment-string\n\nAs the element selection is done for us by 3rd party code there is little use in testing that itself. We rather want to focus on the subsequent filtering of the links. Maybe we can incorporate Matthias suggestion so that we have one integration test incl mark-up, the others based on a mocked `querySelectorAll` result.",
      "parentUuid": "34be5e96_b1f26006",
      "range": {
        "startLine": 4,
        "startChar": 1,
        "endLine": 4,
        "endChar": 24
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0582f550_0a318341",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 12,
      "author": {
        "id": 5897
      },
      "writtenOn": "2019-06-25T11:07:33Z",
      "side": 1,
      "message": "this could be just mocked (that makes also some more testing possible):\n```\nconst querySelectorAll \u003d jest.fn( () \u003d\u003e {\nconst querySelectorAll \u003d jest.fn( () \u003d\u003e {\n                return [\n                        { href: \u0027https://www.wikidata.org/wiki/Q4115189#P31\u0027 },\n                        { href: \u0027/mediawiki/index.php?title\u003dPage_with_sitelink_to_item\u0027 }\n                ] as any;\n        } );\n\n        document.querySelectorAll \u003d querySelectorAll;\n```",
      "range": {
        "startLine": 4,
        "startChar": 1,
        "endLine": 12,
        "endChar": 10
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "221c5984_d5373071",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 12,
      "author": {
        "id": 4699
      },
      "writtenOn": "2019-06-25T11:37:29Z",
      "side": 1,
      "message": "I think testing with the real querySelectorAll() on some fake DOM is a lot better than mocking querySelectorAll, otherwise we’re not testing the selector itself.",
      "parentUuid": "0582f550_0a318341",
      "range": {
        "startLine": 4,
        "startChar": 1,
        "endLine": 12,
        "endChar": 10
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d8ff8662_e11d7802",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 12,
      "author": {
        "id": 5897
      },
      "writtenOn": "2019-06-25T11:41:41Z",
      "side": 1,
      "message": "This would be in my eyes a second test case then.",
      "parentUuid": "221c5984_d5373071",
      "range": {
        "startLine": 4,
        "startChar": 1,
        "endLine": 12,
        "endChar": 10
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2b616be0_c1f007dd",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 12,
      "author": {
        "id": 6546
      },
      "writtenOn": "2019-06-25T11:45:21Z",
      "side": 1,
      "message": "IMHO, that misses the point of the test. It is supposed to test that given the html, the correct links are selected.",
      "parentUuid": "0582f550_0a318341",
      "range": {
        "startLine": 4,
        "startChar": 1,
        "endLine": 12,
        "endChar": 10
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6fbbd64a_99a5619c",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 12,
      "author": {
        "id": 4699
      },
      "writtenOn": "2019-06-25T11:48:26Z",
      "side": 1,
      "message": "I agree – the test shouldn’t even know that the function uses querySelectorAll in my opinion. (It could also use jQuery, for example, and who knows what that does under the hood.)",
      "parentUuid": "2b616be0_c1f007dd",
      "range": {
        "startLine": 4,
        "startChar": 1,
        "endLine": 12,
        "endChar": 10
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1717bd10_bd091945",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 16,
      "author": {
        "id": 5121
      },
      "writtenOn": "2019-06-25T11:02:11Z",
      "side": 1,
      "message": "We should assert that the right link is found.\nGenerally, as this is our bread and butter, this will need to be beefed up a lot.\nAgain - I\u0027m not sure which working mode you envisioned. Cowboy first, clean later; or clean right away.",
      "range": {
        "startLine": 16,
        "startChar": 38,
        "endLine": 16,
        "endChar": 42
      },
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ddfe74bf_d0620d81",
        "filename": "client/data-bridge/tests/unit/mediawiki/linkSelection.spec.ts",
        "patchSetId": 2
      },
      "lineNbr": 16,
      "author": {
        "id": 6546
      },
      "writtenOn": "2019-06-25T11:45:21Z",
      "side": 1,
      "message": "A mixture of both. I guess. Let\u0027s fix this up right now, but implementing extra configuration in another patch.\n\nI added another condition for this patch.",
      "parentUuid": "1717bd10_bd091945",
      "range": {
        "startLine": 16,
        "startChar": 38,
        "endLine": 16,
        "endChar": 42
      },
      "tag": "autogenerated:gerrit:newPatchSet",
      "revId": "748610caba93dc6858c14c88d48fdce897d90fca",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    }
  ]
}