{
  "comments": [
    {
      "key": {
        "uuid": "85e5a81b_bf5fa39d",
        "filename": "repo/includes/Rdf/EntityMentionListener.php",
        "patchSetId": 3
      },
      "lineNbr": 42,
      "author": {
        "id": 2096
      },
      "writtenOn": "2018-08-08T06:54:11Z",
      "side": 1,
      "message": "I don\u0027t think it is the same use case here. As far as I understand, this is for entities mentioning other entities, in which case we may later decide, whether or not we want to output that other entity. In this case, however, we always want to output forms when we output Lexeme, so why not just output them, the same way we output statements for entities?",
      "revId": "8710db959702afa53da08ec9b2307df8fa6050fd",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1f83e536_f23ad3a8",
        "filename": "repo/includes/Rdf/EntityMentionListener.php",
        "patchSetId": 3
      },
      "lineNbr": 42,
      "author": {
        "id": 141
      },
      "writtenOn": "2018-08-08T08:30:38Z",
      "side": 1,
      "message": "Yes, indeed having this method here is not the best place even if this method, just like the other ones, is used to ask for a sometime partial and optional serialization of an other entity.\n \nWe need a way for implementations of EntityRdfBuilder from Wikibase extensions like WikibaseLexeme to call the other RDF builders (e.g. the StatementDocument builders) hopefully without having to build a strong dependency on them. The implementations of EntityRdfBuilder are not able with the current extension design to call RDFBuilder (the dependency is in the other direction) and, so, are not able to directly call the generic conversion codes (for statements...) in an easy and extensible way.\nThe only other way I have seen without making a huge refactoring of the RDF converters core logic is to make LexemeRdfBuilder instantiate its own StatementRdfBuilder and so one for serializing forms and senses statements when they are serialized as part of a lexeme serialization (but not when they are serialized as stand-alone, like for building the answer of Special:EntityData/L1-F1.json). It involved writing much more code and building a strong dependency on how statements are currently serialized, and it does not looked future proof to me and it means that is other Wikibase extension want also to have sub entities they would have to solve the exact same problem again.",
      "parentUuid": "85e5a81b_bf5fa39d",
      "revId": "8710db959702afa53da08ec9b2307df8fa6050fd",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ea0624a5_a6d9dee7",
        "filename": "repo/includes/Rdf/EntityMentionListener.php",
        "patchSetId": 3
      },
      "lineNbr": 42,
      "author": {
        "id": 2096
      },
      "writtenOn": "2018-08-09T06:56:10Z",
      "side": 1,
      "message": "That\u0027s the point - I don\u0027t think it should be either optional or partial. \n\n\u003e to call the other RDF builders (e.g. the StatementDocument builders) hopefully without having to build a strong dependency on them.\n\nNot sure that if you use statement builder you should avoid dependency on it. De-facto dependency then does exist. I haven\u0027t looked into the best way of expressing it (I\u0027m kind of on vacation today and tomorrow) but it feels like doing it through thiese kinds of handlers feels wrong. They are for optional links between entities, not for whole owned sub-entities. If we can\u0027t express sub-entites properly, maybe we should fix it in another place, but not repurpose these listeners for what they aren\u0027t meant for. \n\nI\u0027ll take another look into this once I\u0027m back from vacation and see if I can suggest a better way. \n\n\u003e serializing forms and senses statements when they are serialized as part of a lexeme serialization (but not when they are serialized as stand-alone\n\nAre we ever going to serialize forms as RDF alone? I am not sure there\u0027s a use case for it. I was under impression they exist only inside the Lexeme. \n\n\u003e like for building the answer of Special:EntityData/L1-F1.json\n\nIs this supported? I am not sure we need to even support it. Having just a form without a lexeme doesn\u0027t sound very useful. I mean, I am not exactly against it, but I wouldn\u0027t shed any tears if it wasn\u0027t supported.",
      "parentUuid": "1f83e536_f23ad3a8",
      "revId": "8710db959702afa53da08ec9b2307df8fa6050fd",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9d3066fd_aa2a4681",
        "filename": "repo/includes/Rdf/EntityMentionListener.php",
        "patchSetId": 3
      },
      "lineNbr": 42,
      "author": {
        "id": 141
      },
      "writtenOn": "2018-08-09T07:15:10Z",
      "side": 1,
      "message": "\u003e  If we can\u0027t express sub-entites properly, maybe we should fix it in another place\n\nYes, having something like an EntityWithSubEntities interface that would be implemented for Lexemes seems much nicer to me too.\n\n\u003e Are we ever going to serialize forms as RDF alone?\n\nWe probably need to serialize a \"stub\" for them if they are used as a value in a statement on an other item or lexeme. WikibaseLexemes and Wikidata now provides a \"Lexeme Form id\" datatype.\n\n\u003e Is this supported? I am not sure we need to even support it. \n\nIt is currently working because not actively disabled. At least we need to support \"stubs\" for forms so it looked meaningful to me to also support full output of just one form.",
      "parentUuid": "ea0624a5_a6d9dee7",
      "revId": "8710db959702afa53da08ec9b2307df8fa6050fd",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d6c684d7_c335d9d4",
        "filename": "repo/includes/Rdf/RdfBuilder.php",
        "patchSetId": 3
      },
      "lineNbr": 272,
      "author": {
        "id": 2096
      },
      "writtenOn": "2018-08-08T06:54:11Z",
      "side": 1,
      "message": "Same here - why we need to queue anything? Why can\u0027t we output the forms when we output the data for the lexeme, just as we output other parts? I don\u0027t see any reason to make any special queue for them, am I missing something?",
      "revId": "8710db959702afa53da08ec9b2307df8fa6050fd",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5ce3ac15_7681a620",
        "filename": "repo/includes/Rdf/RdfBuilder.php",
        "patchSetId": 3
      },
      "lineNbr": 272,
      "author": {
        "id": 141
      },
      "writtenOn": "2018-08-08T08:30:38Z",
      "side": 1,
      "message": "I used a queue here in order to get a nicer RDF output. I wanted to output the forms and senses after the output of the lexeme in itself is finished in order to get Turtle like:\n\nwd:L1 ontolex:form wd:L1-F1 , wd:L1-F1 .\nwd:L1-F1 .... .\nwd:L1-F2 .... .\n\nand not like:\n\nwd:L1 ontolex:form wd:L1-F1 .\nwd:L1-F1 .... .\nwd:L1 ontolex:form wd:L1-F2 .\nwd:L1-F2 .... .",
      "parentUuid": "d6c684d7_c335d9d4",
      "revId": "8710db959702afa53da08ec9b2307df8fa6050fd",
      "serverId": "e9e9afe9-4712-486d-8885-f54b72dd1951",
      "unresolved": true
    }
  ]
}